# –î–ó-3: Softmax Regression

## –ö–∞–∫ —Å–¥–∞–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ –∏ –≤ –∫–∞–∫–æ–π —Å—Ä–æ–∫

### –û—Ü–µ–Ω–∫–∞
–ó–∞ –∑–∞–¥–∞–Ω–∏–µ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å 10 –±–∞–ª–ª–æ–≤, –µ—Å–ª–∏ —Å–¥–∞—Ç—å –¥–æ Soft Deadline. –ü–æ—Å–ª–µ –Ω–µ–≥–æ, –Ω–æ –¥–æ Hard Deadline -- 5 –±–∞–ª–ª–æ–≤. –ü–æ—Å–ª–µ —Ä–µ—à–µ–Ω–∏–µ –Ω–µ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è.

### –î–µ–¥–ª–∞–π–Ω—ã
**Soft Deadline - 30 –º–∞—Ä—Ç–∞ –≤ 23:59.**

**Hard Deadline - 06 –∞–ø—Ä–µ–ª—è –≤ 23:59.**

### –§–æ—Ä–º–∞—Ç —Å–¥–∞—á–∏
–ü–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å –ø–µ—Ä–≤—ã–º –∏ –≤—Ç–æ—Ä—ã–º –¥–∑:
1. –ù—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å `git pull` –≤ —Å–≤–æ–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π `master` –≤–µ—Ç–∫–µ.
2. –ù—É–∂–Ω–æ –∑–∞–≤–µ—Å—Ç–∏ –≤–µ—Ç–∫—É `hw3` –∏ –≤–µ—Å—Ç–∏ —Å–≤–æ—é —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É —Ç–∞–º.
3. –°–≤–æ—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–æ–ø–∏—à–∏—Ç–µ –≤ —Ñ–∞–π–ª–µ `hw3/solution.py`, –¥–ª—è –≤–∞—Å —É–∂–µ –≥–æ—Ç–æ–≤–∞ –∑–∞–≥–æ—Ç–æ–≤–∫–∞ –∫–ª–∞—Å—Å–∞.
4. –õ–æ–∫–∞–ª—å–Ω–æ —Ç–µ—Å—Ç—ã –º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–∞–∫:

    ```
   python -m pytest --log-cli-level INFO hw3/tests/
   ```
5. –ö–∞–∫ —Ç–æ–ª—å–∫–æ —Å—á–∏—Ç–∞–µ—Ç–µ, —á—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ, –∑–∞–≤–æ–¥–∏—Ç–µ Merge Request –∏–∑ –≤–µ—Ç–∫–∏ `hw3` –≤ `master`.
6. –ï—Å–ª–∏ —Å –ø—Ä–æ—à–ª—ã–º –ú–†-–æ–º —á—Ç–æ-—Ç–æ –±—ã–ª–æ –Ω–µ —Ç–∞–∫ –∏ –≤—ã —Ä–µ—à–∏–ª–∏ –∑–∞–≤–µ—Å—Ç–∏ –Ω–æ–≤—ã–π, –∑–∞–∫—Ä–æ–π—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å—Ç–∞—Ä—ã–π —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –ú–†-–∞: –¢—Ä–æ–µ—Ç–æ—á–∏–µ -> Close merge request.
7. –ï—Å–ª–∏ –ø–∞–π–ø–ª–∞–π–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ—Ö–æ–¥–∏—Ç (–≤—Å–µ –∑–µ–ª–µ–Ω–Ω–æ–µ), –±–æ—Ç –æ—Ç–ø–∏—Å–∞–ª –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –±–∞–ª–ª–∞–º–∏ –≤ –≤–∞—à MR, —Å—Ç–∞–≤—å—Ç–µ –≤ assigne `–í–ª–∞–¥–∏—Å–ª–∞–≤ –ï—Ñ–∏–º–æ–≤`.
8. Profit!

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—à–µ–Ω–∏—é
–ù—É–∂–Ω–æ:
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å mini-batch softmax –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é.
2. –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –∫–ª–∞—Å—Å–∞.
3. –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –¥–≤–∞ –≤–∏–¥–∞ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏: `l1` –∏ `l2`.
4. –ù–∞–ø–∏—Å–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≤—Å–µ—Ö –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–Ω—ã—Ö –≤ —Ç–µ–ª–µ –∫–ª–∞—Å—Å–∞ –º–µ—Ç–æ–¥–æ–≤.
5. –î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø–æ—è—Å–Ω–µ–Ω–∏–π –∑–∞ —á—Ç–æ –∫–∞–∂–¥—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –∏ –º–µ—Ç–æ–¥ –æ—Ç–≤–µ—á–∞–µ—Ç —Å–ª–µ–¥—É–µ—Ç –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ sklearn –∫–ª–∞—Å—Å–∞ [SGDClassifier](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html).
6. –í –º–µ—Ç–æ–¥–µ `get_penalty_grad` –æ–∂–∏–¥–∞–µ—Ç—Å—è, —á—Ç–æ –≤—ã –≤–µ—Ä–Ω–µ—Ç–µ –≥—Ä–∞–¥–∏–µ–Ω—Ç –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ (—Å—Ä–∞–∑—É —Å —É—á–µ—Ç–æ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `alpha`). –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∏—Ç–æ–≥–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç –±—É–¥–µ—Ç –≤—ã—á–∏—Å–ª—è—Ç—å—Å—è —É—Å–ª–æ–≤–Ω–æ —Ç–∞–∫:

    ```grad = loss_grad + get_penalty_grad()```
7. –í –º–µ—Ç–æ–¥–µ `softmax` —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ softmax –æ—Ç –≤—Ö–æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ / –º–∞—Ç—Ä–∏—Ü—ã. –û–∂–∏–¥–∞–µ–º—ã–µ –≤—Ö–æ–¥—ã –∏ –≤—ã—Ö–æ–¥—ã –æ–ø–∏—Å–∞–Ω—ã –≤ docstring-–µ –º–µ—Ç–æ–¥–∞, –∞ —Ç–∞–∫–∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑—É—á–∏—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–µ—Å—Ç.
8. –í —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∞—à–µ–≥–æ —Ä–µ—à–µ–Ω–∏—è –º–æ–∂–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ numpy, scipy –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏ Python.
9. –û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å —Ç–µ—Å—Ç–∞–º–∏, –∫–∞–∫ –∏ —á—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤—ã —Å–º–æ–∂–µ—Ç–µ –≤ –ø–∞–ø–∫–µ tests.
10. –í –æ–±—â–µ–º —Å–ª—É—á–∞–µ –≤–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø–æ –∫–∞—á–µ—Å—Ç–≤—É –º–µ–Ω–µ–µ —á–µ–º –Ω–∞ 10% —Ö—É–∂–µ sklean (–∞ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —á–∞—Å—Ç–æ –æ–Ω–æ –¥–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å—Å—è –¥–∞–∂–µ –ª—É—á—à–µ! üòâ).
11. –ü–æ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—É—á–µ–Ω–∏—è —É –≤–∞—Å –∑–∞–ø–∞—Å –≤ 6 —Ä–∞–∑ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å sklearn. –° —É—á–µ—Ç–æ–º —Ç–æ–≥–æ, —á—Ç–æ –≤–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ –±—É–¥–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ mini-batch —Ä–µ–∂–∏–º–µ, —Ç–∞–º –∑–∞–ø–∞—Å –¥–æ–≤–æ–ª—å–Ω–æ —Ö–æ—Ä–æ—à–∏–π.
